---
page_title: "ogo_shield_site Resource - terraform-provider-ogo"
subcategory: ""
description: |-
  Resource ogo_shield_site can be used to create, update or delete site configuration in Ogo Dashboard.
  This resource allowed to manage all site settings.
  ogo_shield_clusters and ogo_shield_tlsoptions data sources can be used to retrieve UID needed in ogo_shield_site resource configuration.
---

# ogo_shield_site (Resource)

Resource `ogo_shield_site` can be used to create, update or delete site configuration in Ogo Dashboard.

This resource allowed to manage all site settings.

`ogo_shield_clusters` and `ogo_shield_tlsoptions` data sources can be used to retrieve UID needed in `ogo_shield_site` resource configuration.

## Example Usage

```terraform
# Define variable with default cluster UID to used in sites definition
variable "cluster_uid" {
  type        = string
  description = "Default Cluster ID where sites will be provisioned"
  default     = "802448cf-e2f9-40eb-b0d8-2983e018a0f4"
}

# Simple example with only required attributes
resource "ogo_shield_site" "foo_example_com" {
  domain_name          = "foo.example.com"
  cluster_uid          = var.cluster_uid
  origin_server        = "172.18.1.10"
}

# Complete example with all attributes
resource "ogo_shield_site" "bar_example_com" {
  domain_name             = "bar.example.com"
  cluster_uid             = var.cluster_uid
  origin_server           = "172.18.1.11"
  origin_scheme           = "https"
  origin_skip_cert_verify = true
  origin_mtls_enabled     = false
  remove_xforwarded       = false
  log_export_enabled      = false
  force_https             = true
  audit_mode              = false
  passthrough_mode        = false
  hsts                    = "hstss"
  tlsoptions_uid         = "example00812-f4d2574e-d85e-5dg7-ad11-1edd0489jmp1"
  pass_tls_client_cert    = "info"
  tags                    = ["app", "dev"]
  blacklisted_countries   = ["DE", "EN", "FR", "IT"]
  rewrite_rules = [
    {
      active              = true
      comment             = "Rewrite old to new"
      priority            = 1
      rewrite_destination = "/new"
      rewrite_source      = "^/old"
    },
    {
      active              = true
      comment             = "Rewrite from to"
      priority            = 2
      rewrite_destination = "/to"
      rewrite_source      = "^/from"
    }
  ]
  rules = [
    {
      priority        = 1
      comment         = "Admin from office"
      paths           = ["/admin", "/wp-admin"]
      whitelisted_ips = ["fded:b552:6f7e:fc6f::/64", "10.10.9.0/24"]
    },
    {
      priority        = 2
      comment         = "Monitoring from office"
      paths           = ["/monitor"]
      whitelisted_ips = ["10.10.10.1/32"]
    }
  ]
  url_exceptions = [
    {
      path    = "/demo"
      comment = "demo"
    },
    {
      path    = "/monitoring"
      comment = "Supervision"
    },
  ]
  ip_exceptions = [
    {
      ip      = "131.220.78.219/32"
      comment = "Home IPv4"
    },
    {
      ip      = "fda1:a9bb:d292:ada6::/64"
      comment = "Home IPv6"
    },
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cluster_uid` (String) Cluster UID on which site is deployed (force site recreation if modified). List of available cluster and associated UID can be retrieved from `ogo_shield_clusters` data source
- `domain_name` (String) DNS domain name of site
- `origin_server` (String) Origin server address (IP address or domain name)

### Optional

- `audit_mode` (Boolean) Enable audit mode. Requests are analysed by Ogo Shield but never blocked (Default: **false**)
- `blacklisted_countries` (Set of String) List of countries to blacklist
- `force_https` (Boolean) Redirect HTTP request to HTTPS (Default: **true** )
- `hsts` (String) Enable HSTS (Default: **hsts**). Supported values:
  * **hsts**: Enable HSTS
  * **hstss**: Enable HSTS including subdomains
  * **hstsp**: Enable HSTS including subdomains and preloading
  * **none**: Disable HSTS
- `ip_exceptions` (Attributes Set) Passthrough mode for IPs. Requests from those IPs will never be blocked. (see [below for nested schema](#nestedatt--ip_exceptions))
- `log_export_enabled` (Boolean) Enable log export for this site (Default: **false**)
- `origin_mtls_enabled` (Boolean) Enable mTLS between Ogo and origin server (Default: **false**)
- `origin_port` (Number) Port to be used to access origin server. Must be defined only if different to standard HTTP port 443 or 80, otherwise let Ogo choose the correct port
- `origin_scheme` (String) Scheme to used to access origin server. Supported values: **https** or **http** (Default: **https**)
- `origin_skip_cert_verify` (Boolean) Skip origin server certificate verification if TLS is used. If set to **true** Ogo accept connection to origin server even if certificate doesn't match site domain name, or certificate is expired, or certificate is self signed (Default: **false**)
- `pass_tls_client_cert` (String) Client certificate information to pass to origin server (Default: **info**). Supported values:
  * **all**: Send certificate and certificate information
  * **cert**: Send only certificate
  * **info**: Send only certificate information
  * **none***: Nothing send
- `passthrough_mode` (Boolean) Enable passthrough mode. Requests are not analysed by Ogo Shield and never blocked (Default: **false**)
- `remove_xforwarded` (Boolean) Remove X-Forwarded-* headers. (Default: **false** )
- `rewrite_rules` (Attributes Set) Rewrite a path of your website. (see [below for nested schema](#nestedatt--rewrite_rules))
- `rules` (Attributes Set) Restrict access to given URLs. The engine stops at the first URL match. (see [below for nested schema](#nestedatt--rules))
- `tags` (Set of String) List of tags
- `tlsoptions_uid` (String) UID of TLS options to be applied to this site. List of available TLS options and associated UID can be retrieved from `ogo_shield_tlsoptions` data source
- `url_exceptions` (Attributes Set) Passthrough mode on URL regular expressions. The matching requests will never be blocked. (see [below for nested schema](#nestedatt--url_exceptions))

### Read-Only

- `last_updated` (String) Last resource update by terraform

<a id="nestedatt--ip_exceptions"></a>
### Nested Schema for `ip_exceptions`

Required:

- `ip` (String) IP address list never blocked by Ogo Shield

Optional:

- `comment` (String) Description associated to this IP list


<a id="nestedatt--rewrite_rules"></a>
### Nested Schema for `rewrite_rules`

Required:

- `priority` (Number) Rewrite rule priority
- `rewrite_destination` (String) Rewrited destination path
- `rewrite_source` (String) Source path to be rewrited

Optional:

- `active` (Boolean) Flag to enabled (**true**) or disabled (**false**) rewrite rule. (Default: **true**)
- `comment` (String) Description associated to this rewrite rule


<a id="nestedatt--rules"></a>
### Nested Schema for `rules`

Required:

- `paths` (Set of String) List of URL path for which rule is applied
- `priority` (Number) Rule priority
- `whitelisted_ips` (Set of String) Authorized IP addresses list

Optional:

- `action` (String) Action to applied when rule match (Default: **brain**). Supported values:
  * **brain**: Rule analysed by ogo Shield brain
  * **bypass**: Rule not analysed by Ogo Shield brain
- `active` (Boolean) Flag to enabled (**true**) or disabled (**false**) rule. (Default: **true**)
- `cache` (Boolean) Enable or disable caching on this rule. Option can be used only if site caching is enabled. (Default: **false**)
- `comment` (String) Description associated to this rule


<a id="nestedatt--url_exceptions"></a>
### Nested Schema for `url_exceptions`

Required:

- `path` (String) Path of URL never blocked by Ogo Shield

Optional:

- `comment` (String) Description associated to this URL exception


## Import

Import is supported using the following syntax:

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
# Import foo.ogosecurity.com existing site from OGO Dashboard to resource foo_ogosecurity_com in terraform state
terraform import ogo_shield_site.foo_ogosecurity_com foo.ogosecurity.com
```

