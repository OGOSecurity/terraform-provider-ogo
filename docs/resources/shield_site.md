---
page_title: "ogo_shield_site Resource - ogo"
subcategory: ""
description: |-
  Resource ogo_shield_site can be used to create, update or delete sites configuration in Ogo Dashboard.
  This resource allowed to manage all site settings.
  ogo_shield_clusters and ogo_shield_tlsoptions data sources can be used to retrieve UID needed in ogo_shield_site resource configuration.
---

# ogo_shield_site (Resource)

Resource `ogo_shield_site` can be used to create, update or delete sites configuration in Ogo Dashboard.

This resource allowed to manage all site settings.

`ogo_shield_clusters` and `ogo_shield_tlsoptions` data sources can be used to retrieve UID needed in `ogo_shield_site` resource configuration.

## Example Usage

```terraform
# Define variable with default cluster UID to used in sites definition
variable "cluster_uid" {
  type        = string
  description = "Default Cluster ID where sites will be provisioned"
  default     = "802448cf-e2f9-40eb-b0d8-2983e018a0f4"
}

# Simple example with only required attributes
resource "ogo_shield_site" "foo_example_com" {
  domain_name   = "foo.example.com"
  cluster_uid   = var.cluster_uid
  origin_server = "172.18.1.10"
}

# Complete example with all attributes
resource "ogo_shield_site" "bar_example_com" {
  domain_name             = "bar.example.com"
  cluster_uid             = var.cluster_uid
  origin_server           = "172.18.1.11"
  origin_scheme           = "https"
  origin_skip_cert_verify = true
  origin_mtls_enabled     = false
  remove_xforwarded       = false
  log_export_enabled      = false
  force_https             = true
  audit_mode              = false
  passthrough_mode        = false
  hsts                    = "hstss"
  tlsoptions_uid          = "example00812-f4d2574e-d85e-5dg7-ad11-1edd0489jmp1"
  pass_tls_client_cert    = "info"
  tags                    = ["app", "dev"]
  blacklisted_countries   = ["DE", "EN", "FR", "IT"]
  brain_overrides = {
    "/BRAIN/DRIVE_43E5A99D_5A09_47FC_A9D9_C4FF0248B6C1_Priority"                   = 0.88
    "/ACTOR/DRIVE_493EE2EC_4776_4A98_8D56_75C2DDD28215_BELIEF"                     = 0.66
    "/ACTOR/DRIVE_E550246A_FA9A_4EB9_AFA5_C4C3D7C3FBA8_MAX_CONSUMED_RESPONSE_TIME" = 0.55
  }
  rewrite_rules = [
    {
      active              = true
      comment             = "Rewrite old to new"
      rewrite_source      = "^/old"
      rewrite_destination = "/new"
    },
    {
      active              = true
      comment             = "Rewrite from to"
      rewrite_source      = "^/from"
      rewrite_destination = "/to"
    }
  ]
  rules = [
    {
      comment         = "Admin from office"
      paths           = ["/admin", "/wp-admin"]
      whitelisted_ips = ["fded:b552:6f7e:fc6f::/64", "10.10.9.0/24"]
    },
    {
      comment         = "Monitoring from office"
      paths           = ["/monitor"]
      whitelisted_ips = ["10.10.10.1/32"]
    }
  ]
  url_exceptions = [
    {
      path    = "/demo"
      comment = "demo"
    },
    {
      path    = "/monitoring"
      comment = "Supervision"
    },
  ]
  ip_exceptions = [
    {
      ip      = "131.220.78.219/32"
      comment = "Home IPv4"
    },
    {
      ip      = "fda1:a9bb:d292:ada6::/64"
      comment = "Home IPv6"
    },
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cluster_uid` (String) Cluster UID on which site is deployed (force site recreation if modified). List of available cluster and associated UID can be retrieved from `ogo_shield_clusters` data source.
- `domain_name` (String) DNS domain name of site.
- `origin_server` (String) Origin server address (IP address or domain name).

### Optional

- `active_customer_certificate` (Attributes) P12/PFX certificate to be used for this site. (see [below for nested schema](#nestedatt--active_customer_certificate))
- `audit_mode` (Boolean) Enable audit mode. Requests are analysed by Ogo Shield but never blocked (Default: **false**).
- `blacklisted_countries` (Set of String) List of countries to blacklist.
- `brain_overrides` (Map of Number) List of brain parameters to override
- `cache_enabled` (Boolean) Enable cache for this site if supported by cluster (Default: **false**).
- `cdn` (String) Select CDN to be used for this site if supported by cluster.
- `contract_number` (String) Contract number to which the site is attached, only required if multiple contract exist for this organization. List of available contract can be retrieved from `ogo_shield_contrats` data source.
- `force_https` (Boolean) Redirect HTTP request to HTTPS (Default: **false** ).
- `hsts` (String) Enable HSTS (Default: **hsts**). Supported values:
  * **hsts**: Enable HSTS
  * **hstss**: Enable HSTS including subdomains
  * **hstsp**: Enable HSTS including subdomains and preloading
  * **none**: Disable HSTS.
- `ip_exceptions` (Attributes Set) Passthrough mode for IPs. Requests from those IPs will never be blocked. (see [below for nested schema](#nestedatt--ip_exceptions))
- `log_export_enabled` (Boolean) Enable log export for this site (Default: **false**).
- `origin_mtls_enabled` (Boolean) Enable mTLS between Ogo and origin server (Default: **false**).
- `origin_port` (Number) Port to be used to access origin server. Must be defined only if different to standard HTTP port 443 or 80, otherwise let Ogo choose the correct port.
- `origin_scheme` (String) Scheme to used to access origin server. Supported values: **https** or **http** (Default: **https**).
- `origin_skip_cert_verify` (Boolean) Skip origin server certificate verification if TLS is used. If set to **true** Ogo accept connection to origin server even if certificate doesn't match site domain name, or certificate is expired, or certificate is self signed (Default: **false**).
- `pass_tls_client_cert` (String) Client certificate information to pass to origin server (Default: **info**). Supported values:
  * **all**: Send certificate and certificate information
  * **cert**: Send only certificate
  * **info**: Send only certificate information
  * **none***: Nothing send.
- `passthrough_mode` (Boolean) Enable passthrough mode. Requests are not analysed by Ogo Shield and never blocked (Default: **false**).
- `remove_xforwarded` (Boolean) Remove X-Forwarded-* headers. (Default: **false** ).
- `rewrite_rules` (Attributes List) Rewrite a path of your website. Rewrite rules are parsed in order of declaration. (see [below for nested schema](#nestedatt--rewrite_rules))
- `rules` (Attributes List) Restrict access to given URLs. Rules are parsed in order of declaration. The engine stops at the first URL match. (see [below for nested schema](#nestedatt--rules))
- `tags` (Set of String) List of tags.
- `tlsoptions_uid` (String) UID of TLS options to be applied to this site. List of available TLS options and associated UID can be retrieved from `ogo_shield_tlsoptions` data source.
- `url_exceptions` (Attributes Set) Passthrough mode on URL regular expressions. The matching requests will never be blocked. (see [below for nested schema](#nestedatt--url_exceptions))

### Read-Only

- `cdn_status` (String) Retrieve CDN status if CDN is enabled.
 Available state:
  * **ACTIVE**: CDN is enabled and ready to be used.
  * **ACTIVATION_IN_PROGRESS**: CDN is enabled and first activation is in progress.
  * **SYNC_IN_PROGRESS**: New configuration is waiting to be applied on CDN.
- `cluster_entrypoint_4` (String) IPv4 cluster entrypoint to which site DNS record can be configured.
- `cluster_entrypoint_6` (String) IPv6 cluster entrypoint to which site DNS record can be configured.
- `cluster_entrypoint_cdn` (String) CDN entrypoint to which site DNS record can be configured.
- `last_updated` (String) Last resource update by terraform.
- `status` (String) Get site status. Available state:
  * **CREATED**: Site just created, waiting for DNS to be configured for site domain name to redirect to Ogo Shield cluster.
  * **DNS_ERROR**: Partial DNS configuration.
  * **ONLINE**: Site is properly provisioned, but no active TLS certificate is present (ephemeral state).
  * **LE_CERT**: Site is properly provisioned, DNS is configured on Ogo Shield cluster and site is protected with a Let's Encrypt certificate.
  * **CUST_CERT**: Site is properly provisioned, DNS is configured on Ogo Shield cluster and site is protected with a customer certificate.
  * **LE_EXP**: Site is properly provisioned, DNS is configured on Ogo Shield cluster and site is protected with an expired Let's Encrypt certificate.
  * **CUST_EXP**: Site is properly provisioned, DNS is configured on Ogo Shield cluster and site is protected with an expired customer certificate.
  * **OFFLIINE**: Site has been properly provisioned and configured on Ogo Shield cluster, but DNS no longer redirect on Ogo Shield cluster.

<a id="nestedatt--active_customer_certificate"></a>
### Nested Schema for `active_customer_certificate`

Required:

- `p12_password` (String, Sensitive) Password used to decrypt P12 file.

Optional:

- `hash` (String) Hash of the certificate generated from P12 content.
- `p12_content64` (String) P12/PFX content encoded in base64 (conflicts with `p12_file`).
- `p12_file` (String) P12/PFX file path containing certificate and key (conflicts with `p12_content64`).

Read-Only:

- `cn` (String) Common name of this certificate.
- `expired_at` (String) Expiration date of this certificate.


<a id="nestedatt--ip_exceptions"></a>
### Nested Schema for `ip_exceptions`

Required:

- `ip` (String) IP address list never blocked by Ogo Shield.

Optional:

- `comment` (String) Description associated to this IP list.


<a id="nestedatt--rewrite_rules"></a>
### Nested Schema for `rewrite_rules`

Required:

- `rewrite_destination` (String) Rewrited destination path.
- `rewrite_source` (String) Source path to be rewrited.

Optional:

- `active` (Boolean) Flag to enabled (**true**) or disabled (**false**) rewrite rule. (Default: **true**).
- `comment` (String) Description associated to this rewrite rule.


<a id="nestedatt--rules"></a>
### Nested Schema for `rules`

Required:

- `paths` (Set of String) List of URL path for which rule is applied.
- `whitelisted_ips` (Set of String) Authorized IP addresses list.

Optional:

- `action` (String) Action to applied when rule match (Default: **brain**). Supported values:
  * **brain**: Rule analysed by ogo Shield brain
  * **bypass**: Rule not analysed by Ogo Shield brain.
- `active` (Boolean) Flag to enabled (**true**) or disabled (**false**) rule. (Default: **true**).
- `cache` (Boolean) Enable or disable caching on this rule. Option can be used only if site caching is enabled. (Default: **false**).
- `comment` (String) Description associated to this rule.


<a id="nestedatt--url_exceptions"></a>
### Nested Schema for `url_exceptions`

Required:

- `path` (String) Path of URL never blocked by Ogo Shield.

Optional:

- `comment` (String) Description associated to this URL exception.


## Import

Import is supported using the following syntax:

```shell
# Import foo.ogosecurity.com existing site from OGO Dashboard to resource foo_ogosecurity_com in terraform state
terraform import ogo_shield_site.foo_ogosecurity_com foo.ogosecurity.com
```

More information of how to use [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import).


